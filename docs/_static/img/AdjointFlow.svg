<?xml version="1.0" encoding="UTF-8"?>
<!-- Do not edit this file with editors other than diagrams.net -->
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="785px" height="1046px" viewBox="-0.5 -0.5 785 1046" content="&lt;mxfile host=&quot;app.diagrams.net&quot; modified=&quot;2022-12-21T17:45:38.936Z&quot; agent=&quot;5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.0 Safari/605.1.15&quot; etag=&quot;QwMn7XrfvbEm2ue3JKeL&quot; version=&quot;20.7.4&quot; type=&quot;google&quot;&gt;&lt;diagram id=&quot;C5RBs43oDa-KdzZeNtuy&quot; name=&quot;Page-1&quot;&gt;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&lt;/diagram&gt;&lt;/mxfile&gt;" style="background-color: rgb(255, 255, 255);"><defs><clipPath id="mx-clip-244-245-102-26-0"><rect x="244" y="245" width="102" height="26"/></clipPath><clipPath id="mx-clip-244-271-102-26-0"><rect x="244" y="271" width="102" height="26"/></clipPath><clipPath id="mx-clip-244-297-102-26-0"><rect x="244" y="297" width="102" height="26"/></clipPath><clipPath id="mx-clip-244-323-102-26-0"><rect x="244" y="323" width="102" height="26"/></clipPath><clipPath id="mx-clip-244-349-102-26-0"><rect x="244" y="349" width="102" height="26"/></clipPath><clipPath id="mx-clip-244-435-102-26-0"><rect x="244" y="435" width="102" height="26"/></clipPath><clipPath id="mx-clip-244-461-102-26-0"><rect x="244" y="461" width="102" height="26"/></clipPath><clipPath id="mx-clip-244-487-102-26-0"><rect x="244" y="487" width="102" height="26"/></clipPath><clipPath id="mx-clip-244-513-102-26-0"><rect x="244" y="513" width="102" height="26"/></clipPath><clipPath id="mx-clip-244-539-102-26-0"><rect x="244" y="539" width="102" height="26"/></clipPath><clipPath id="mx-clip-244-565-102-26-0"><rect x="244" y="565" width="102" height="26"/></clipPath><clipPath id="mx-clip-402-513-158-26-0"><rect x="402" y="513" width="158" height="26"/></clipPath><clipPath id="mx-clip-402-539-158-26-0"><rect x="402" y="539" width="158" height="26"/></clipPath><clipPath id="mx-clip-402-565-158-26-0"><rect x="402" y="565" width="158" height="26"/></clipPath><clipPath id="mx-clip-402-245-159-26-0"><rect x="402" y="245" width="159" height="26"/></clipPath><clipPath id="mx-clip-402-271-159-26-0"><rect x="402" y="271" width="159" height="26"/></clipPath><clipPath id="mx-clip-492-915-112-26-0"><rect x="492" y="915" width="112" height="26"/></clipPath><clipPath id="mx-clip-492-941-112-26-0"><rect x="492" y="941" width="112" height="26"/></clipPath><clipPath id="mx-clip-492-967-112-26-0"><rect x="492" y="967" width="112" height="26"/></clipPath><clipPath id="mx-clip-492-993-112-26-0"><rect x="492" y="993" width="112" height="26"/></clipPath><clipPath id="mx-clip-179-993-158-26-0"><rect x="179" y="993" width="158" height="26"/></clipPath><clipPath id="mx-clip-493-731-152-26-0"><rect x="493" y="731" width="152" height="26"/></clipPath><clipPath id="mx-clip-179-675-102-26-0"><rect x="179" y="675" width="102" height="26"/></clipPath><clipPath id="mx-clip-179-701-102-26-0"><rect x="179" y="701" width="102" height="26"/></clipPath><clipPath id="mx-clip-179-727-102-26-0"><rect x="179" y="727" width="102" height="26"/></clipPath><clipPath id="mx-clip-179-753-102-26-0"><rect x="179" y="753" width="102" height="26"/></clipPath><clipPath id="mx-clip-179-779-102-26-0"><rect x="179" y="779" width="102" height="26"/></clipPath><clipPath id="mx-clip-564-35-137-24-0"><rect x="564" y="35" width="137" height="24"/></clipPath><clipPath id="mx-clip-564-59-137-20-0"><rect x="564" y="59" width="137" height="20"/></clipPath><clipPath id="mx-clip-564-79-137-20-0"><rect x="564" y="79" width="137" height="20"/></clipPath><clipPath id="mx-clip-564-99-137-20-0"><rect x="564" y="99" width="137" height="20"/></clipPath><clipPath id="mx-clip-564-119-137-20-0"><rect x="564" y="119" width="137" height="20"/></clipPath></defs><g><rect x="84" y="834" width="621" height="210" rx="31.5" ry="31.5" fill="none" stroke="#ff6666" stroke-opacity="0.5" stroke-width="3" stroke-dasharray="9 9" pointer-events="all"/><rect x="84" y="174" width="621" height="210" rx="31.5" ry="31.5" fill="none" stroke="#66cc00" stroke-opacity="0.5" stroke-width="3" stroke-dasharray="9 9" pointer-events="all"/><rect x="84" y="609" width="621" height="215" rx="34.4" ry="34.4" fill="none" stroke="#b266ff" stroke-opacity="0.5" stroke-width="3" stroke-dasharray="9 9" pointer-events="all"/><rect x="84" y="394" width="621" height="206" rx="30.9" ry="30.9" fill="none" stroke="#007fff" stroke-opacity="0.5" stroke-width="3" stroke-dasharray="9 9" pointer-events="all"/><path d="M 295 374 L 295 397.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 295 402.88 L 291.5 395.88 L 295 397.63 L 298.5 395.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><path d="M 240 240 L 240 214 L 350 214 L 350 240" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><path d="M 240 240 L 240 374 L 350 374 L 350 240" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 240 240 L 350 240" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><g fill="rgb(0, 0, 0)" font-family="Helvetica" font-style="italic" pointer-events="none" text-anchor="middle" font-size="12px"><text x="294.5" y="231.5">ORIG Simulation</text></g><g fill="rgb(0, 0, 0)" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-244-245-102-26-0)" font-size="12px"><text x="245.5" y="257.5">sources</text></g><g fill="rgb(0, 0, 0)" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-244-271-102-26-0)" font-size="12px"><text x="245.5" y="283.5">structures</text></g><g fill="rgb(0, 0, 0)" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-244-297-102-26-0)" font-size="12px"><text x="245.5" y="309.5">input_structures</text></g><g fill="rgb(0, 0, 0)" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-244-323-102-26-0)" font-size="12px"><text x="245.5" y="335.5">monitors</text></g><g fill="rgb(0, 0, 0)" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-244-349-102-26-0)" font-size="12px"><text x="245.5" y="361.5">output_monitors</text></g><path d="M 240 430 L 240 404 L 350 404 L 350 430" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 240 430 L 240 586 L 350 586 L 350 430" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 240 430 L 350 430" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><g fill="rgb(0, 0, 0)" font-family="Helvetica" font-style="italic" pointer-events="none" text-anchor="middle" font-size="12px"><text x="294.5" y="421.5">FWD Simulation</text></g><g fill="rgb(0, 0, 0)" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-244-435-102-26-0)" font-size="12px"><text x="245.5" y="447.5">sources</text></g><g fill="rgb(0, 0, 0)" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-244-461-102-26-0)" font-size="12px"><text x="245.5" y="473.5">structures</text></g><g fill="rgb(0, 0, 0)" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-244-487-102-26-0)" font-size="12px"><text x="245.5" y="499.5">input_structures</text></g><g fill="rgb(0, 0, 0)" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-244-513-102-26-0)" font-size="12px"><text x="245.5" y="525.5">monitors</text></g><g fill="rgb(0, 0, 0)" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-244-539-102-26-0)" font-size="12px"><text x="245.5" y="551.5">output_monitors</text></g><g fill="rgb(0, 0, 0)" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-244-565-102-26-0)" font-size="12px"><text x="245.5" y="577.5">grad_monitors</text></g><path d="M 398 508 L 398 482 L 564 482 L 564 508" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 398 508 L 398 586 L 564 586 L 564 508" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 398 508 L 564 508" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><g fill="rgb(0, 0, 0)" font-family="Helvetica" font-style="italic" pointer-events="none" text-anchor="middle" font-size="12px"><text x="480.5" y="499.5">FWD SimData</text></g><g fill="rgb(0, 0, 0)" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-402-513-158-26-0)" font-size="12px"><text x="403.5" y="525.5">data : MonitorData</text></g><g fill="rgb(0, 0, 0)" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-402-539-158-26-0)" font-size="12px"><text x="403.5" y="551.5">output_data : JaxModeData</text></g><g fill="rgb(0, 0, 0)" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-402-565-158-26-0)" font-size="12px"><text x="403.5" y="577.5">grad_data : FieldData</text></g><path d="M 215 305 L 233.63 305" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 238.88 305 L 231.88 308.5 L 233.63 305 L 231.88 301.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 155 305 L 125 305 L 125 698.63" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 125 703.88 L 121.5 696.88 L 125 698.63 L 128.5 696.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><ellipse cx="185" cy="305" rx="30" ry="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 58px; height: 1px; padding-top: 305px; margin-left: 156px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">f(*args)</div></div></div></foreignObject><text x="185" y="309" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">f(*args)</text></switch></g><path d="M 60 239 L 185 239 L 185 268.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 185 273.88 L 181.5 266.88 L 185 268.63 L 188.5 266.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><rect x="0" y="229" width="60" height="20" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 58px; height: 1px; padding-top: 239px; margin-left: 1px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">*args</div></div></div></foreignObject><text x="30" y="243" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">*args</text></switch></g><path d="M 664 279 L 717.63 279" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 722.88 279 L 715.88 282.5 L 717.63 279 L 715.88 275.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 634 309 L 634 617.63" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 634 622.88 L 630.5 615.88 L 634 617.63 L 637.5 615.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><ellipse cx="634" cy="279" rx="30" ry="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 58px; height: 1px; padding-top: 279px; margin-left: 605px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">g(*data)</div></div></div></foreignObject><text x="634" y="283" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">g(*data)</text></switch></g><path d="M 397.5 240 L 397.5 214 L 564 214 L 564 240" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 397.5 240 L 397.5 294 L 564 294 L 564 240" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 397.5 240 L 564 240" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><g fill="rgb(0, 0, 0)" font-family="Helvetica" font-style="italic" pointer-events="none" text-anchor="middle" font-size="12px"><text x="480.25" y="231.5">ORIG SimulationData</text></g><g fill="rgb(0, 0, 0)" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-402-245-159-26-0)" font-size="12px"><text x="403" y="257.5">data : MonitorData</text></g><g fill="rgb(0, 0, 0)" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-402-271-159-26-0)" font-size="12px"><text x="403" y="283.5">output_data : JaxModeData</text></g><path d="M 564 279 L 597.63 279" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 602.88 279 L 595.88 282.5 L 597.63 279 L 595.88 275.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 350 573 L 391.63 573" fill="none" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><path d="M 396.88 573 L 389.88 576.5 L 391.63 573 L 389.88 569.5 Z" fill="#ff0000" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><path d="M 350 547 L 391.63 547" fill="none" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><path d="M 396.88 547 L 389.88 550.5 L 391.63 547 L 389.88 543.5 Z" fill="#ff0000" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><path d="M 350 521 L 391.63 521" fill="none" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><path d="M 396.88 521 L 389.88 524.5 L 391.63 521 L 389.88 517.5 Z" fill="#ff0000" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><rect x="724" y="269" width="60" height="20" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 58px; height: 1px; padding-top: 279px; margin-left: 725px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">J(*args)</div></div></div></foreignObject><text x="754" y="283" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">J(*args)</text></switch></g><path d="M 488 910 L 488 884 L 608 884 L 608 910" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 488 910 L 488 1020 L 608 1020 L 608 910" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 488 910 L 608 910" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><g fill="rgb(0, 0, 0)" font-family="Helvetica" font-style="italic" pointer-events="none" text-anchor="middle" font-size="12px"><text x="547.5" y="901.5">ADJ Simulation</text></g><g fill="rgb(0, 0, 0)" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-492-915-112-26-0)" font-size="12px"><text x="493.5" y="927.5">sources</text></g><g fill="rgb(0, 0, 0)" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-492-941-112-26-0)" font-size="12px"><text x="493.5" y="953.5">structures</text></g><g fill="rgb(0, 0, 0)" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-492-967-112-26-0)" font-size="12px"><text x="493.5" y="979.5">input_structures</text></g><g fill="rgb(0, 0, 0)" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-492-993-112-26-0)" font-size="12px"><text x="493.5" y="1005.5">grad_monitors</text></g><path d="M 175 988 L 175 962 L 341 962 L 341 988" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 175 988 L 175 1014 L 341 1014 L 341 988" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 175 988 L 341 988" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><g fill="rgb(0, 0, 0)" font-family="Helvetica" font-style="italic" pointer-events="none" text-anchor="middle" font-size="12px"><text x="257.5" y="979.5">ADJ SimulationData</text></g><g fill="rgb(0, 0, 0)" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-179-993-158-26-0)" font-size="12px"><text x="180.5" y="1005.5">grad_data : FieldData</text></g><path d="M 489 725.5 L 489 699.5 L 649 699.5 L 649 725.5" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 489 725.5 L 489 754 L 649 754 L 649 725.5" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 489 725.5 L 649 725.5" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><g fill="rgb(0, 0, 0)" font-family="Helvetica" font-style="italic" pointer-events="none" text-anchor="middle" font-size="12px"><text x="568.5" y="717">VJP SimulationData</text></g><g fill="rgb(0, 0, 0)" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-493-731-152-26-0)" font-size="12px"><text x="494.5" y="743">output_data : JaxModeData</text></g><path d="M 175 670 L 175 644 L 285 644 L 285 670" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 175 670 L 175 804 L 285 804 L 285 670" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 175 670 L 285 670" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><g fill="rgb(0, 0, 0)" font-family="Helvetica" font-style="italic" pointer-events="none" text-anchor="middle" font-size="12px"><text x="229.5" y="661.5">VJP Simulation</text></g><g fill="rgb(0, 0, 0)" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-179-675-102-26-0)" font-size="12px"><text x="180.5" y="687.5">sources</text></g><g fill="rgb(0, 0, 0)" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-179-701-102-26-0)" font-size="12px"><text x="180.5" y="713.5">structures</text></g><g fill="rgb(0, 0, 0)" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-179-727-102-26-0)" font-size="12px"><text x="180.5" y="739.5">input_structures</text></g><g fill="rgb(0, 0, 0)" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-179-753-102-26-0)" font-size="12px"><text x="180.5" y="765.5">monitors</text></g><g fill="rgb(0, 0, 0)" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-179-779-102-26-0)" font-size="12px"><text x="180.5" y="791.5">output_monitors</text></g><path d="M 664 654 L 684 654 L 684 738.5 L 655.37 738.5" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 650.12 738.5 L 657.12 735 L 655.37 738.5 L 657.12 742 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><ellipse cx="634" cy="654" rx="30" ry="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 58px; height: 1px; padding-top: 654px; margin-left: 605px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">grad(g)</div></div></div></foreignObject><text x="634" y="658" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">grad(g)</text></switch></g><path d="M 175 735 L 161.37 735" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 156.12 735 L 163.12 731.5 L 161.37 735 L 163.12 738.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 95 735 L 30 735 L 30 380.37" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 30 375.12 L 33.5 382.12 L 30 380.37 L 26.5 382.12 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><ellipse cx="125" cy="735" rx="30" ry="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 58px; height: 1px; padding-top: 735px; margin-left: 96px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">grad(f)</div></div></div></foreignObject><text x="125" y="739" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">grad(f)</text></switch></g><path d="M 30 314 L 30 301.37" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 30 296.12 L 33.5 303.12 L 30 301.37 L 26.5 303.12 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><ellipse cx="30" cy="344" rx="30" ry="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 58px; height: 1px; padding-top: 344px; margin-left: 1px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">grad(J)</div></div></div></foreignObject><text x="30" y="348" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">grad(J)</text></switch></g><path d="M 564 573 L 584 573 L 584 632.5 L 379 632.5 L 379 672.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 379 677.88 L 375.5 670.88 L 379 672.63 L 382.5 670.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 379 739 L 379 774 L 317 774 L 317 735 L 291.37 735" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 286.12 735 L 293.12 731.5 L 291.37 735 L 293.12 738.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><ellipse cx="379" cy="709" rx="30" ry="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 58px; height: 1px; padding-top: 709px; margin-left: 350px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">store_vjp</div></div></div></foreignObject><text x="379" y="713" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">store_vjp</text></switch></g><path d="M 197 568 L 190 568 L 190 573 L 233.63 573" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 238.88 573 L 231.88 576.5 L 233.63 573 L 231.88 569.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><ellipse cx="197" cy="538" rx="30" ry="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 58px; height: 1px; padding-top: 538px; margin-left: 168px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">add<br />grad<br />monitors</div></div></div></foreignObject><text x="197" y="542" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">add...</text></switch></g><path d="M 240 495 L 197 495 L 197 501.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 197 506.88 L 193.5 499.88 L 197 501.63 L 200.5 499.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 469 854 L 469 848 L 468 848 L 468 923 L 481.63 923" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 486.88 923 L 479.88 926.5 L 481.63 923 L 479.88 919.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><ellipse cx="469" cy="824" rx="30" ry="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 58px; height: 1px; padding-top: 824px; margin-left: 440px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">to<br />adjoint<br />src</div></div></div></foreignObject><text x="469" y="828" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">to...</text></switch></g><path d="M 489 738.5 L 469 738.5 L 469 787.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 469 792.88 L 465.5 785.88 L 469 787.63 L 472.5 785.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><rect x="0" y="275" width="60" height="20" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 58px; height: 1px; padding-top: 285px; margin-left: 1px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">dJ(*args)</div></div></div></foreignObject><text x="30" y="289" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">dJ(*args)</text></switch></g><path d="M 664 1018 L 664 1034 L 624 1034 L 624 1001 L 614.37 1001" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 609.12 1001 L 616.12 997.5 L 614.37 1001 L 616.12 1004.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><ellipse cx="664" cy="988" rx="30" ry="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 58px; height: 1px; padding-top: 988px; margin-left: 635px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: normal; overflow-wrap: normal;">add<br />grad<br />monitors</div></div></div></foreignObject><text x="664" y="992" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">add...</text></switch></g><path d="M 285 709 L 342.63 709" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 347.88 709 L 340.88 712.5 L 342.63 709 L 340.88 705.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 488 1001 L 347.37 1001" fill="none" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><path d="M 342.12 1001 L 349.12 997.5 L 347.37 1001 L 349.12 1004.5 Z" fill="#ff0000" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><path d="M 175 1001 L 155 1001 L 155 884 L 429 884 L 429 709 L 415.37 709" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 410.12 709 L 417.12 705.5 L 415.37 709 L 417.12 712.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 189px; margin-left: 395px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: nowrap;"><font color="#4d9900">User Simulation / Objective Definition</font></div></div></div></foreignObject><text x="395" y="193" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">User Simulation / Objective Definiti...</text></switch></g><path d="M 564 521 L 584 521 L 584 364 L 364 364 L 364 253 L 391.13 253" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 396.38 253 L 389.38 256.5 L 391.13 253 L 389.38 249.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 564 547 L 604 547 L 604 344 L 378 344 L 378 279 L 391.13 279" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 396.38 279 L 389.38 282.5 L 391.13 279 L 389.38 275.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 409px; margin-left: 489px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: nowrap;"><font color="#007fff">Forward Simulation</font></div></div></div></foreignObject><text x="489" y="413" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">Forward Simulation</text></switch></g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 624px; margin-left: 300px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: nowrap;"><font color="#9933ff">VJP passing</font></div></div></div></foreignObject><text x="300" y="628" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">VJP passing</text></switch></g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 849px; margin-left: 304px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: none; white-space: nowrap;"><font color="#ff6666">Adjoint Simulation</font></div></div></div></foreignObject><text x="304" y="853" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">Adjoint Simulation</text></switch></g><path d="M 560 30 L 560 4 L 705 4 L 705 30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 560 30 L 560 144 L 705 144 L 705 30" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><path d="M 560 30 L 705 30" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="none"/><g fill="rgb(0, 0, 0)" font-family="Helvetica" font-style="italic" pointer-events="none" text-anchor="middle" font-size="12px"><text x="632" y="21.5">Legend</text></g><g fill="rgb(0, 0, 0)" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-564-35-137-24-0)" font-size="12px"><text x="565.5" y="47.5">In / Out data</text></g><g fill="rgb(0, 0, 0)" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-564-59-137-20-0)" font-size="12px"><text x="565.5" y="71.5">Passing data</text></g><g fill="rgb(0, 0, 0)" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-564-79-137-20-0)" font-size="12px"><text x="565.5" y="91.5">Jax Operation</text></g><g fill="rgb(0, 0, 0)" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-564-99-137-20-0)" font-size="12px"><text x="565.5" y="111.5">Function call</text></g><g fill="rgb(0, 0, 0)" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-564-119-137-20-0)" font-size="12px"><text x="565.5" y="131.5">Tidy3d Simulation</text></g><rect x="655" y="38" width="25.5" height="10" fill="none" stroke="#000000" pointer-events="none"/><path d="M 659 88 L 682.63 88" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 687.88 88 L 680.88 91.5 L 682.63 88 L 680.88 84.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 658 68 L 681.63 68" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 686.88 68 L 679.88 71.5 L 681.63 68 L 679.88 64.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><ellipse cx="672" cy="106" rx="10" ry="10" fill="none" stroke="#000000" pointer-events="none"/><path d="M 680 43 L 688.63 43" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 693.88 43 L 686.88 46.5 L 688.63 43 L 686.88 39.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 682 106 L 690.63 106" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 695.88 106 L 688.88 109.5 L 690.63 106 L 688.88 102.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 647 107 L 655.63 107" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 660.88 107 L 653.88 110.5 L 655.63 107 L 653.88 103.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 608 975 L 624 975 L 624 938 L 664 938 L 664 951.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 664 956.88 L 660.5 949.88 L 664 951.63 L 667.5 949.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 28px; margin-left: 86px;"><div data-drawio-colors="color: #333333; " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 24px; font-family: Helvetica; color: rgb(51, 51, 51); line-height: 1.2; pointer-events: none; font-weight: bold; white-space: nowrap;">Adjoint Gradient <br />Calculation Pipeline</div></div></div></foreignObject><text x="86" y="35" fill="#333333" font-family="Helvetica" font-size="24px" font-weight="bold">Adjoint...</text></switch></g><path d="M 658 129 L 681.63 129" fill="none" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><path d="M 686.88 129 L 679.88 132.5 L 681.63 129 L 679.88 125.5 Z" fill="#ff0000" stroke="#ff0000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 120px; margin-left: 76px;"><div data-drawio-colors="color: #333333; " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(51, 51, 51); line-height: 1.2; pointer-events: none; white-space: nowrap;"><u>Context:<br /></u><ul><li>User defines objective fn: <font face="Courier New">J(*args) -&gt; float</font><br /></li><li>Sim. structures are fn of args: <font face="Courier New">simulation.input_structures = f(*args)</font></li><li>Data is generated through simulation: <font face="Courier New">sim_data = web.run(simulation)</font></li><li>Objective depends on monitor data: <font face="Courier New">J = g(sim_data.output_monitors)</font></li><li>User wants to calculate <font face="Courier New">J(*args)</font> and <font face="Courier New">dJ/dargs(*args)</font> (the gradient)</li></ul></div></div></div></foreignObject><text x="76" y="124" fill="#333333" font-family="Helvetica" font-size="12px">Context:...</text></switch></g><path d="M 64 239 L 74 239 L 74 344 L 66.37 344" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 61.12 344 L 68.12 340.5 L 66.37 344 L 68.12 347.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://www.diagrams.net/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Text is not SVG - cannot display</text></a></switch></svg>